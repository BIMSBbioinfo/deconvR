roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
?elementMetadata
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
?S4Vectors::elementMetadata
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
S4Vectors::elementMetadata()
?S4Vectors::elementMetadata()
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
?methylKit::
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
gc()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
gc()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
?mcols
?mcols
?GenomicRanges::mcols
?mcols
devtools::document()
roxygen2::roxygenize(clean = TRUE)
gc()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
?GenomicRanges::mcols
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
gc()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
devtools::document()
roxygen2::roxygenize(clean = TRUE)
BiocCheck::BiocCheck()
?merge.data.table
roxygen2::roxygenize(clean = TRUE)
devtools::document()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
styler::style_pkg(transformers = biocthis::bioc_style(indent_by = 4))
path <- system.file(package = "deconvR")
BiocCheck::BiocCheckGitClone(path)
BiocCheck::BiocCheckGitClone(path)
path <- system.file(package = "deconvR")
BiocCheck::BiocCheckGitClone(path)
BiocCheck::BiocCheckGitClone()
knitr::opts_chunk$set(tidy = FALSE,
cache = FALSE,
dev = "png",
message = FALSE,
error = FALSE,
warning = FALSE)
BiocStyle::markdown()
library(knitr)
library(deconvR)
library(doParallel)
library(dplyr)
cl <- parallel::makeCluster(2)
doParallel::registerDoParallel(cl)
atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
head(atlas)
data("WGBS_GRanges")
WGBS_GRanges
data("probe_ids")
probe_ids
library(deconvR)
atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
head(atlas)
samples <- simulateCellMix(3)[[1]]
head(samples)
sampleMeta <- data.table("Experiment_accession" = colnames(samples)[-1],
"Biosample_term_name" = "new cell type")
head(sampleMeta)
extended_matrix <- findSignatures(samples = samples,
sampleMeta = sampleMeta,
atlas = atlas)
head(extended_matrix)
data("WGBS_GRanges")
WGBS_GRanges
head(methylKit::methRead(system.file("extdata", "test1.myCpG.txt",
package = "methylKit"), sample.id="test",
assembly="hg38", treatment=1, context="CpG", mincov = 0))
data("probe_ids")
probe_ids
mapped_WGBS_data <- BSmeth2Probe(probe_id_locations = probe_ids,
WGBS_data = WGBS_GRanges,
multipleMapping = TRUE,
cutoff = 100)
head(mapped_WGBS_data)
deconvolution <- deconvolute(reference = extended_matrix,
bulk = mapped_WGBS_data)
deconvolution[[1]]
devtools::check()
tdyr::drop_na
tidyr::drop_na()
?drop_na
devtools::document()
devtools::check()
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
dplyr::drop_na
?drop_na
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
devtools::document()
?na.omit
?drop_nas
?drop_na
devtools::document()
devtools::document()
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("test_BSmeth2Probe.R")
testthat::test_file("test_findSignatures.R")
roxygen2::roxygenise(clean = TRUE)
testthat::test_file("test_simulateCellMix.R")
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
gc()
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
devtools::document()
roxygen2::roxygenise(clean = TRUE)
testthat::test_file("test_simulateCellMix.R")
testthat::test_file("tests/testthat/test_simulateCellMix.R")
testthat::test_file("tests/testthat/test_BSmeth2Probe.R")
testthat::test_file("tests/testthat/test_deconvolute.R")
library(deconvR)
ref_atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
simulation <- simulateCellMix(5)
bulkTable <- simulation[[1]]
proportionsTable <- simulation[[2]]
deconvolution <- deconvolute(bulk = bulkTable, model = "nnls")
ref_atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
simulation <- simulateCellMix(5)
bulkTable <- simulation[[1]]
proportionsTable <- simulation[[2]]
deconvolution <- deconvolute(bulk = bulkTable, model = "rlm")
results <- deconvolution[[1]]
partial_rsq <- deconvolution[[2]]
vectorlength <- NROW(tidyr::drop_na(merge(bulkTable, ref_atlas, by = "IDs"))[, -1])
library(testthat)
vectorlength <- NROW(tidyr::drop_na(merge(bulkTable, ref_atlas, by = "IDs"))[, -1])
expect_output(deconvolute(bulk = bulkTable, model = "rlm"), message("DECONVOLUTION WITH RLM", "\n"))
expect_output(deconvolute(bulk = bulkTable, model = "rlm"), message("SUMMARY OF PARTIAL R-SQUARED VALUES FOR RLM : "))
expect_equal(dim(results), c(5, length(colnames(ref_atlas[, -1]))))
expect_equal(dim(deconvolute(bulk = bulkTable[-1, ], model = "rlm")[[1]]), c(5, length(colnames(ref_atlas[, -1]))))
expect_equal(colnames(results), colnames(ref_atlas[, -1]))
expect_equal(lapply(unlist(results[, ]), typeof)[[1]], print("double"), ignore_attr = TRUE)
expect_equal(sum(results[1, ]), 1)
expect_equal(sum(results[2, ]), 1)
expect_equal(sum(results[3, ]), 1)
expect_equal(sum(results[4, ]), 1)
test_that("deconvolute rlm", {
ref_atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
simulation <- simulateCellMix(5)
bulkTable <- simulation[[1]]
proportionsTable <- simulation[[2]]
deconvolution <- deconvolute(bulk = bulkTable, model = "rlm")
results <- deconvolution[[1]]
partial_rsq <- deconvolution[[2]]
vectorlength <- NROW(tidyr::drop_na(merge(bulkTable, ref_atlas, by = "IDs"))[, -1])
expect_output(deconvolute(bulk = bulkTable, model = "rlm"), message("DECONVOLUTION WITH RLM", "\n"))
expect_output(deconvolute(bulk = bulkTable, model = "rlm"), message("SUMMARY OF PARTIAL R-SQUARED VALUES FOR RLM : "))
expect_equal(dim(results), c(5, length(colnames(ref_atlas[, -1]))))
expect_equal(dim(deconvolute(bulk = bulkTable[-1, ], model = "rlm")[[1]]), c(5, length(colnames(ref_atlas[, -1]))))
expect_equal(colnames(results), colnames(ref_atlas[, -1]))
expect_equal(lapply(unlist(results[, ]), typeof)[[1]], print("double"), ignore_attr = TRUE)
expect_equal(sum(results[1, ]), 1)
expect_equal(sum(results[2, ]), 1)
expect_equal(sum(results[3, ]), 1)
expect_equal(sum(results[4, ]), 1)
expect_equal(sum(results[5, ]), 1)
expect_error(deconvolute(bulk = bulkTable[, -1], model = "rlm"))
expect_error(deconvolute(bulk = bulkTable, model = "rlm", vec = rep_len(1, vectorlength)), NA)
expect_error(deconvolute(bulk = bulkTable, model = "rlm", vec = rep_len(1, vectorlength - 1)))
expect_error(deconvolute(model = "rlm"))
expect_equal(dim(results), dim(proportionsTable))
expect_equal(colnames(results), colnames(ref_atlas[, -1]))
expect_equal(rownames(results), rownames(proportionsTable))
expect_equal(length(partial_rsq), length(simulation[[1]]) - 1)
})
devtools::document()
roxygen2::roxygenise(clean = TRUE)
bulkTable <- simulation[[1]]
devtools::check()
devtools::document()
roxygen2::roxygen
roxygen2::roxygenize(clean = TRUE)
roxygen2::roxygen
roxygen2::roxygen
devtools::document()
devtools::check()
?dplyr::select()
knitr::opts_chunk$set(tidy = FALSE,
cache = FALSE,
dev = "png",
message = FALSE,
error = FALSE,
warning = FALSE)
BiocStyle::markdown()
library(knitr)
library(deconvR)
library(doParallel)
library(dplyr)
cl <- parallel::makeCluster(2)
doParallel::registerDoParallel(cl)
atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
head(atlas)
data("WGBS_GRanges")
WGBS_GRanges
data("probe_ids")
probe_ids
library(deconvR)
atlas <- readRDS(system.file("reference_atlas_nodup.RDS", package = "deconvR"))
head(atlas)
samples <- simulateCellMix(3)[[1]]
head(samples)
sampleMeta <- data.table("Experiment_accession" = colnames(samples)[-1],
"Biosample_term_name" = "new cell type")
head(sampleMeta)
extended_matrix <- findSignatures(samples = samples,
sampleMeta = sampleMeta,
atlas = atlas)
head(extended_matrix)
data("WGBS_GRanges")
WGBS_GRanges
head(methylKit::methRead(system.file("extdata", "test1.myCpG.txt",
package = "methylKit"), sample.id="test",
assembly="hg38", treatment=1, context="CpG", mincov = 0))
data("probe_ids")
probe_ids
mapped_WGBS_data <- BSmeth2Probe(probe_id_locations = probe_ids,
WGBS_data = WGBS_GRanges,
multipleMapping = TRUE,
cutoff = 100)
head(mapped_WGBS_data)
deconvolution <- deconvolute(reference = extended_matrix,
bulk = mapped_WGBS_data)
testthat::test_file("tests/testthat/test_deconvolute.R")
?select
multipleMapping = TRUE
devtools::document()
roxygen2::roxygenise(clean = TRUE)
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenise(clean = TRUE)
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenize()
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
?MASS
?MASS::select()
?select
?packagename::fun()
devtools::document()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
?rsq::rsq.partial()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
devtools::check()
BiocCheck::BiocCheck()
library(nnls)
devtools::document()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::check()
devtools::document()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::check()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
install.packages("roxygen2")
install.packages("roxygen2")
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("tests/testthat/test_deconvolute.R")
BiocCheck::BiocCheck()
roxygen2::roxygenize()
testthat::test_file("tests/testthat/test_deconvolute.R")
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
devtools::document()
BiocCheck::BiocCheck()
? data.table::.SD
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
BiocCheck::BiocCheck()
devtools::document()
BiocCheck::BiocCheck()
roxygen2::roxygenise(clean = TUE)
roxygen2::roxygenise(clean = TRUE)
BiocCheck::BiocCheck()
roxygen2::roxygenise(clean = TRUE)
BiocCheck::BiocCheck()
devtools::check()
rsq::rsq.partial
?rsq::rsq.partial
roxygen2::roxygenise(clean = TRUE)
devtools::document()
devtools::check()
BiocCheck::BiocCheck()
path <- system.file(package = "deconvR")
BiocCheck::BiocCheckGitClone(path)
path <- system.file(package = "deconvR")
BiocCheck::BiocCheckGitClone(path)
path <- system.file(package = "deconvR")
BiocCheck::BiocCheckGitClone(path)
devtools::check()
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
roxygen2::roxygenise(clean = TRUE)
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("tests/testthat/test_deconvolute.R")
devtools::document()
testthat::test_file("tests/testthat/test_deconvolute.R")
testthat::test_file("test_deconvolute.R")
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
roxygen2::roxygenise(clean = TRUE)
setwd("~/GitHub/deconvR")
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
git ls-files -i -c --exclude-from=.gitignore | %{git rm --cached $_}
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
BiocCheck::BiocCheckGitClone()
